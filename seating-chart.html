<!DOCTYPE html>
<html>
<head>
    <meta charset="UTF-8">
    <title>FGHS Auditorium v2.0</title>
    <meta http-equiv="Cache-Control" content="no-cache, no-store, must-revalidate">
    <meta http-equiv="Pragma" content="no-cache">
    <meta http-equiv="Expires" content="0">
    <link href="https://fonts.googleapis.com/css2?family=Archivo:wght@300;400;600;700&family=JetBrains+Mono:wght@400;500&display=swap" rel="stylesheet">
    <style>
        :root {
            --bg-primary: #0a0e1a;
            --bg-secondary: #141822;
            --bg-tertiary: #1a1f2e;
            --accent-emerald: #10b981;
            --accent-ruby: #DA2128;
            --accent-amber: #f59e0b;
            --school-blue: #33A3DC;
            --text-primary: #e5e7eb;
            --text-secondary: #9ca3af;
            --border-color: #2d3748;
        }
        * { margin: 0; padding: 0; box-sizing: border-box; }
        body { 
            font-family: 'Archivo', sans-serif;
            background: var(--bg-primary);
            color: var(--text-primary);
            padding: 2rem;
        }
        .container { max-width: 1800px; margin: 0 auto; }
        .header {
            margin-bottom: 3rem;
            border-bottom: 2px solid var(--border-color);
            padding-bottom: 2rem;
        }
        .header-content { display: flex; align-items: center; gap: 1.5rem; }
        .header h1 {
            font-size: 2.5rem;
            background: linear-gradient(135deg, var(--school-blue), #DA2128);
            -webkit-background-clip: text;
            -webkit-text-fill-color: transparent;
            background-clip: text;
        }
        .header p { color: var(--text-secondary); font-family: 'JetBrains Mono', monospace; }
        .section {
            background: var(--bg-secondary);
            border: 1px solid var(--border-color);
            border-radius: 12px;
            padding: 2rem;
            margin-bottom: 2rem;
        }
        .section h2 {
            font-size: 1.5rem;
            background: linear-gradient(90deg, var(--school-blue), #DA2128);
            -webkit-background-clip: text;
            -webkit-text-fill-color: transparent;
            background-clip: text;
            margin-bottom: 1rem;
        }
        .controls { display: flex; gap: 1rem; margin: 1.5rem 0; flex-wrap: wrap; }
        input[type="date"] {
            background: var(--bg-tertiary);
            border: 1px solid var(--border-color);
            color: var(--text-primary);
            padding: 0.625rem 1rem;
            border-radius: 6px;
            font-family: 'JetBrains Mono', monospace;
        }
        button {
            background: var(--bg-tertiary);
            color: var(--text-primary);
            border: 1px solid var(--border-color);
            padding: 0.625rem 1.25rem;
            border-radius: 6px;
            cursor: pointer;
            font-family: 'Archivo', sans-serif;
            font-size: 0.875rem;
            font-weight: 600;
            text-transform: uppercase;
        }
        button:hover { background: var(--bg-primary); border-color: var(--school-blue); }
        button.active { background: var(--school-blue); color: white; }
        button.danger { background: #DA2128; color: white; }
        button.small { padding: 0.375rem 0.75rem; font-size: 0.75rem; }
        .descriptions {
            background: var(--bg-tertiary);
            padding: 1.5rem;
            border-radius: 8px;
            margin-bottom: 1.5rem;
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(300px, 1fr));
            gap: 1rem;
        }
        .desc-item { font-size: 0.875rem; color: var(--text-secondary); }
        .desc-item strong { color: var(--text-primary); display: block; margin-bottom: 0.25rem; }
        .date-list { margin-top: 1rem; }
        .date-item {
            background: var(--bg-tertiary);
            padding: 1.5rem;
            margin: 0.5rem 0;
            border-radius: 8px;
            display: flex;
            justify-content: space-between;
            align-items: center;
        }
        .date-name {
            cursor: pointer;
            font-family: 'JetBrains Mono', monospace;
            font-weight: 600;
            flex: 1;
        }
        .date-name:hover { color: var(--school-blue); }
        .hidden { display: none !important; }
        .legend {
            display: flex;
            gap: 2rem;
            background: var(--bg-secondary);
            padding: 1.25rem;
            border-radius: 12px;
            margin-bottom: 2rem;
        }
        .legend-item { display: flex; align-items: center; gap: 0.75rem; }
        .legend-box {
            width: 32px;
            height: 32px;
            border-radius: 6px;
        }
        .legend-box.available { background: var(--accent-emerald); }
        .legend-box.booked { background: #DA2128; }
        .legend-box.selected { background: var(--accent-amber); }
        .stage {
            background: linear-gradient(180deg, var(--bg-tertiary), var(--bg-secondary));
            border: 2px solid var(--border-color);
            border-radius: 12px;
            padding: 1.5rem;
            text-align: center;
            margin-bottom: 2rem;
        }
        .stage h2 {
            font-size: 1.5rem;
            background: linear-gradient(90deg, var(--school-blue), #DA2128);
            -webkit-background-clip: text;
            -webkit-text-fill-color: transparent;
            background-clip: text;
        }
        .seating { background: var(--bg-secondary); padding: 2rem; border-radius: 12px; overflow-x: auto; }
        .sec { margin: 2rem 0; }
        .sec-title {
            font-weight: 700;
            background: linear-gradient(90deg, var(--school-blue), #DA2128);
            -webkit-background-clip: text;
            -webkit-text-fill-color: transparent;
            background-clip: text;
            margin-bottom: 1rem;
            padding-bottom: 0.5rem;
            border-bottom: 1px solid var(--border-color);
        }
        .row-cont { display: flex; gap: 3rem; justify-content: center; margin: 5px 0; }
        .row { display: flex; gap: 4px; align-items: center; }
        .row-lbl {
            font-family: 'JetBrains Mono', monospace;
            font-size: 0.7rem;
            min-width: 40px;
            text-align: center;
            color: var(--text-secondary);
        }
        .seats { display: flex; gap: 4px; }
        .seat {
            width: 26px;
            height: 26px;
            border-radius: 5px;
            cursor: pointer;
            border: 2px solid;
        }
        .seat.available { background: var(--accent-emerald); border-color: rgba(16, 185, 129, 0.5); }
        .seat.selected { background: var(--accent-amber); border-color: var(--accent-amber); }
        .seat.booked { background: #DA2128; border-color: rgba(218, 33, 40, 0.5); cursor: not-allowed; }
        .stats {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(200px, 1fr));
            gap: 1rem;
            margin-top: 2rem;
        }
        .stat {
            background: var(--bg-secondary);
            border: 1px solid var(--border-color);
            border-radius: 12px;
            padding: 1.5rem;
            text-align: center;
        }
        .stat-val {
            font-size: 2rem;
            font-weight: 700;
            font-family: 'JetBrains Mono', monospace;
            margin-bottom: 0.5rem;
        }
        .stat.available .stat-val { color: var(--accent-emerald); }
        .stat.booked .stat-val { color: #DA2128; }
        .stat.selected .stat-val { color: var(--accent-amber); }
    </style>
</head>
<body>
    <div class="container">
        <div class="header">
            <div class="header-content">
                <div>
                    <svg width="80" height="80" viewBox="0 0 100 100">
                        <circle cx="50" cy="50" r="40" fill="none" stroke="#33A3DC" stroke-width="3"/>
                        <circle cx="50" cy="50" r="20" fill="#DA2128" opacity="0.6"/>
                    </svg>
                </div>
                <div>
                    <h1>FGHS Auditorium</h1>
                    <p>FELTON GROVE HIGH SCHOOL · APEX, NC · 852 SEATS</p>
                </div>
            </div>
        </div>
        
        <div class="section" id="dateView">
            <h2>Show Dates</h2>
            <p style="color: var(--text-secondary); margin-bottom: 1rem;">
                Manage multiple show dates. Each date has its own seating chart.
            </p>
            <div class="controls">
                <input type="date" id="dateInput">
                <button onclick="doAddDate()">Add Show Date</button>
            </div>
            <div class="descriptions">
                <div class="desc-item">
                    <strong>Add Show Date:</strong> Select a date and click to create a new seating chart.
                </div>
                <div class="desc-item">
                    <strong>Delete Date:</strong> Click the red Delete button to remove a show date.
                </div>
            </div>
            <div id="dateList" class="date-list"></div>
        </div>
        
        <div class="section hidden" id="chartView">
            <h2 id="chartTitle"></h2>
            <div class="controls">
                <button id="selectBtn" class="active" onclick="doSelectMode()">Select Seats</button>
                <button onclick="doBookSeats()">Book Selected</button>
                <button onclick="doUnbookMode()">Unbook Seats</button>
                <button onclick="doClearSel()">Clear Selection</button>
                <button onclick="doResetAll()">Reset All</button>
                <button onclick="doBackToDates()">← Back to Dates</button>
            </div>
            <div class="descriptions">
                <div class="desc-item"><strong>Select Seats:</strong> Click seats to select (amber).</div>
                <div class="desc-item"><strong>Book Selected:</strong> Mark selected as booked (red).</div>
                <div class="desc-item"><strong>Unbook Seats:</strong> Click booked seats to unbook.</div>
                <div class="desc-item"><strong>Clear Selection:</strong> Remove selections.</div>
                <div class="desc-item"><strong>Reset All:</strong> Clear all bookings for this date.</div>
            </div>
            <div class="legend">
                <div class="legend-item"><div class="legend-box available"></div><span>Available</span></div>
                <div class="legend-item"><div class="legend-box booked"></div><span>Booked</span></div>
                <div class="legend-item"><div class="legend-box selected"></div><span>Selected</span></div>
            </div>
            <div class="stage"><h2>STAGE</h2></div>
            <div class="seating" id="seatingArea"></div>
            <div class="stats">
                <div class="stat available"><div class="stat-val" id="statAvail">852</div><div>Available</div></div>
                <div class="stat booked"><div class="stat-val" id="statBook">0</div><div>Booked</div></div>
                <div class="stat selected"><div class="stat-val" id="statSel">0</div><div>Selected</div></div>
                <div class="stat"><div class="stat-val">852</div><div>Total</div></div>
            </div>
        </div>
    </div>
    
    <script>
var LAY={left:{front:[{l:'A',s:8},{l:'B',s:12},{l:'C',s:13},{l:'D',s:13},{l:'E',s:14},{l:'F',s:14},{l:'G',s:14},{l:'H',s:15},{l:'J',s:15},{l:'K',s:16}],middle:[{l:'L',s:16},{l:'M',s:19},{l:'N',s:19},{l:'P',s:19},{l:'Q',s:19},{l:'R',s:19},{l:'S',s:19},{l:'T',s:19},{l:'U',s:19},{l:'V',s:19},{l:'W',s:19},{l:'X',s:16},{l:'Y',s:12}],back:[{l:'Z',s:13},{l:'AA',s:13},{l:'BB',s:14},{l:'CC',s:18}]},right:{front:[{l:'A',s:8},{l:'B',s:12},{l:'C',s:13},{l:'D',s:13},{l:'E',s:14},{l:'F',s:14},{l:'G',s:14},{l:'H',s:15},{l:'J',s:15},{l:'K',s:16}],middle:[{l:'L',s:16},{l:'M',s:19},{l:'N',s:19},{l:'P',s:19},{l:'Q',s:19},{l:'R',s:19},{l:'S',s:19},{l:'T',s:19},{l:'U',s:19},{l:'V',s:19},{l:'W',s:19},{l:'X',s:16},{l:'Y',s:12}],back:[{l:'Z',s:13},{l:'AA',s:13},{l:'BB',s:14},{l:'CC',s:18}]}};
var dts=[],curD=null,md='select',sl=new Set(),stD={};
function ld(){var s=localStorage.getItem('dts');if(s)dts=JSON.parse(s);sh();}
function sh(){console.log('Rendering date list. Total dates:', dts.length);var h='',i;for(i=0;i<dts.length;i++){var d=dts[i],ds=new Date(d+'T12:00').toLocaleDateString('en-US',{weekday:'short',month:'short',day:'numeric',year:'numeric'});console.log('Creating button for date index', i, ':', d);h+='<div class="date-item"><div class="date-name" onclick="op(\''+d+'\')">'+ds+'</div><button class="danger small" onclick="del('+i+')">Delete</button></div>';}document.getElementById('dateList').innerHTML=h||'<p style="color:#9ca3af;text-align:center;padding:2rem">No dates yet</p>';console.log('Date list HTML:', document.getElementById('dateList').innerHTML.substring(0, 200));}
function doAddDate(){var v=document.getElementById('dateInput').value;console.log('Add date clicked, value:', v);if(!v){alert('Select a date');return;}if(dts.indexOf(v)>=0){alert('Date exists');return;}dts.push(v);dts.sort();localStorage.setItem('dts',JSON.stringify(dts));document.getElementById('dateInput').value='';sh();}
function del(i){console.log('DELETE FUNCTION CALLED! Index:', i, 'Date:', dts[i]);if(!confirm('Delete this date?'))return;var d=dts[i];dts.splice(i,1);localStorage.setItem('dts',JSON.stringify(dts));localStorage.removeItem('st_'+d);sh();}
function op(d){curD=d;var s=localStorage.getItem('st_'+d);stD=s?JSON.parse(s):{};sl=new Set();md='select';document.getElementById('dateView').classList.add('hidden');document.getElementById('chartView').classList.remove('hidden');document.getElementById('chartTitle').textContent='Show: '+new Date(d+'T12:00').toLocaleDateString('en-US',{weekday:'long',month:'long',day:'numeric',year:'numeric'});bd();up();}
function doBackToDates(){if(curD)localStorage.setItem('st_'+curD,JSON.stringify(stD));document.getElementById('chartView').classList.add('hidden');document.getElementById('dateView').classList.remove('hidden');curD=null;sh();}
function bd(){var h='',ss=['front','middle','back'],tt={front:'Front Section (A-K)',middle:'Middle Section (L-Y)',back:'Back Section (Z-CC)'},s,r,mx,i,j;for(s=0;s<ss.length;s++){var sc=ss[s];h+='<div class="sec"><div class="sec-title">'+tt[sc]+'</div>';mx=Math.max(LAY.left[sc].length,LAY.right[sc].length);for(r=0;r<mx;r++){h+='<div class="row-cont">';if(LAY.left[sc][r])h+=br(LAY.left[sc][r],'L');if(LAY.right[sc][r])h+=br(LAY.right[sc][r],'R');h+='</div>';}h+='</div>';}document.getElementById('seatingArea').innerHTML=h;}
function br(c,sd){var h='<div class="row"><div class="row-lbl">'+c.l+'</div><div class="seats">',i,id,st;for(i=1;i<=c.s;i++){id=c.l+'-'+sd+'-'+i;st=stD[id]||'available';if(sl.has(id))st='selected';h+='<div class="seat '+st+'" onclick="cl(\''+id+'\')"></div>';}h+='</div></div>';return h;}
function cl(id){if(md==='select'){if(stD[id]==='booked')return;if(sl.has(id))sl.delete(id);else sl.add(id);}else if(md==='unbook'&&stD[id]==='booked'){stD[id]='available';localStorage.setItem('st_'+curD,JSON.stringify(stD));}bd();up();}
function doSelectMode(){md='select';document.getElementById('selectBtn').classList.add('active');}
function doUnbookMode(){md='unbook';document.getElementById('selectBtn').classList.remove('active');}
function doBookSeats(){sl.forEach(function(id){stD[id]='booked';});sl=new Set();localStorage.setItem('st_'+curD,JSON.stringify(stD));bd();up();}
function doClearSel(){sl=new Set();bd();up();}
function doResetAll(){if(!confirm('Reset all seats?'))return;stD={};sl=new Set();localStorage.setItem('st_'+curD,JSON.stringify(stD));bd();up();}
function up(){var b=0,k;for(k in stD)if(stD[k]==='booked')b++;document.getElementById('statAvail').textContent=852-b;document.getElementById('statBook').textContent=b;document.getElementById('statSel').textContent=sl.size;}
ld();
    </script>
</body>
</html>
